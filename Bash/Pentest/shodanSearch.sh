#!/bin/bash

#.  Filename: shodanSearch.sh
#.  Version: 1.0
#.  Author: AurÃ©lien DUBUS
#.  Description: Bash script to make some Shodan research


usage() {
  script_name=$(basename $0)
  echo -e "Available options for this script :
          -h : Print this help message.
          -s : Search term.

Example : ./$script_name -s openssl1.0.1
"
}

requirements() {
echo "Checking requirements..."
dpkg -s python >/dev/null 2>&1 || apt-get install python -y >/dev/null 2>&1 
dpkg -s pip >/dev/null 2>&1 || apt-get install pip -y >/dev/null 2>&1 
dpkg -s pip >/dev/null 2>&1 || pip install shodan >/dev/null 2>&1 
shodan >/dev/null 2>&1 || echo "There is a problem with the shodan Python client install"
}

API_KEY=""
requirements

if [ -z "${1}" ]; then
  usage
fi

while getopts "hs:" opt; do
  case $opt in
    h) usage
      ;;
    s) search="$OPTARG"
       concat="_results.txt"
       file="$search$concat"
       shodan search $search > $file
      ;;
  esac
done

exit 0
